# 第16课 读取摇杆值

## 1.实验说明：                                                                                
摇杆模块是一个有两个模拟输入和一个数字输入的组件。广泛应用于游戏操作、机器人控制、无人机控制等领域。摇杆模块的X、Y引脚就是模拟输入，直接读取其测得的模拟值就可，Z轴（B引脚）是数字按钮，要先设置其引脚为输入状态，再读取测到的数值是1（按下）或0（没按下）。将读取到的值打印到串口监视器。

## 2.元件知识：

**摇杆模块：** 主要是采用PS2 手柄摇杆元件，实际上摇杆模块有3个信号端引脚，模拟3维空间，摇杆模块的引脚分别是GND、VCC、信号端（B、X、Y），其中信号端X、Y模拟空间的X轴和Y轴，控制时，模块的X、Y信号端是连接单片机模拟口，通过控制2个模拟输入值来控制物体在空间X、Y轴的坐标。信号端B模拟空间Z轴，它一般是接数字口，做按键使用。
VCC接单片机电源输出端V/VCC（3.3/5V），GND接单片机G/GND，原始状态下读出电压大约为1.65V/2.5V左右，对于X轴方向，当随箭头方向逐渐按下，读出电压值随着增加，且可以达到最大电压，随箭头相反方向逐渐按下，读出电压值逐渐减少，减少到最小电压；对于Y轴方向，当沿着模块上的箭头方向逐渐按下，读出电压值逐渐减少，减少到最小电压，随箭头相反方向逐渐按下，读出电压值随着增加，且可以达到最大电压；对于Z轴方向，信号端B接数字口，原始状态下输出0，按下输出1。这样，我们可以读取两个模拟值和一个数字口的高低电平情况，判断模块上摇杆的工作状态。
**模块参数：**
输入电压：DC 3.3V ~ 5V
输出信号：X/Y双轴模拟值+Z轴数字信号
适用范围：适用于控制点坐标在平面内的运动，双自由度舵机的控制等。
产品特点：外观精美，摇杆手感优越，操作简单，反应灵敏，使用寿命长。

## 3.实验接线： 
![Img](/media/img-20230407093448.png)

## 4.实验准备：                                                                                
（1）将Micro:bit主板正确插入4自由度机械手臂的Microbit 16路舵机扩展板。 
（2）外接电源。 
（3）通过Micro USB线连接Micro:bit和电脑。 
（4）打开离线版本或Web版本的Makecode。 

## 5.实验代码：                                                                               
可以直接加载我们提供的程序，也可以自己通过拖动程序块来编写程序程序，操作步骤如下：
**（1）寻找代码块**
![Img](/media/img-20230417141032.png)
![Img](/media/img-20230417141126.png)
![Img](/media/img-20230417135305.png)
![Img](/media/img-20230417154110.png)
![Img](/media/img-20230417154431.png)
![Img](/media/img-20230417154542.png)
![Img](/media/img-20230417135353.png)

**（2）完整代码程序**
![Img](/media/img-20230327103205.png)

## 6.实验结果：                                                                                
按照之前的方式将程序下载至Micro: bit主板，Micro USB数据线不要拔下来，利用Micro USB数据线上电，并且还利用外接电源供电。打开CoolTerm，点击Options，选择串行Port，设置COM口和波特率，波特率设置为115200（经过测试，Micro:bit的USB串口通讯波特率是115200），点击**OK**后，最后点击**Connect**。CoolTerm的串口监视器显示左边摇杆模块的X、Y引脚的模拟值；右摇杆模块的Y引脚的模拟值和右摇杆模块的B引脚（按钮）的数字信号值，摇动左、右摇杆模块及按下、松开右摇杆模块按钮，模拟值和数字信号值会发生变化。如下图：
![Img](/media/img-20230327103252.png)
![Img](/media/img-20230327103256.png)
![Img](/media/img-20230327103301.png)
![Img](/media/img-20230327103305.png)










