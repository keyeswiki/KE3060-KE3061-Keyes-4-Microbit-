# 第15课 按键控制舵机

## 1.实验说明：                                                                                
在前面的项目实验中，我们已经了解过舵机的控制和Microbit主板上按键的工作原理及应用。那么在这个项目中，我们将学习使用Microbit主板上的按键AB来控制舵机的转动。

## 2.实验接线：  
![Img](/media/img-20230404101458.png)

## 3.实验准备：                                                                                
（1）将Micro:bit主板正确插入4自由度机械手臂的Microbit 16路舵机扩展板。 
（2）外接电源。 
（3）通过Micro USB线连接Micro:bit和电脑。 
（4）打开离线版本或Web版本的Makecode。 
**如果选择通过导入Hex文件来加载项目，则无需手动添加pca9685扩展库。** 
<span style="color: rgb(255, 76, 65);">如果选择手动拖动代码，则首先需要添加pca9685扩展库（详细步骤请参考“开发环境配置”文件）。</span>

## 3.实验代码：                                                                               
本程序实现的功能是通过 AB 键控制舵机2（底座转动舵机）左右转，按 A 键的时候4自由度机械手臂的舵机2（底座转动舵机）向左转，按 B 键的时候4自由度机械手臂的舵机2（底座转动舵机）向右转。
可以直接加载我们提供的程序，也可以自己通过拖动程序块来编写程序程序，操作步骤如下：
**（1）添加库文件**
打开MakeCode，先点击右上角的齿轮图标![Img](/media/img-20230324110032.png)（设置），再点击“扩展”。
![Img](/media/img-20230417131743.png)

或者单击“**高级**”上的“**扩展**”。
![Img](/media/img-20230417131804.png)

在搜索框中输入链接：`https://github.com/keyestudio2019/pxt-pca9685-smallest`，然后单击搜索。 
单击搜索结果pca9685以下载并安装。 该过程可能需要几秒钟。
![Img](/media/img-20230417131953.png)

安装完成后，你可以在左侧找到pca9685的扩展库。
![Img](/media/img-20230417132047.png)
![Img](/media/img-20230417132114.png)
<span style="color: rgb(255, 76, 65);">注意：添加到项目中的扩展库仅对该项目有效，而不会出现在其他项目中。 因此，当你创建新项目代码时，需要再次添加pca9685扩展库。</span>

**（2）寻找代码块**
![Img](/media/img-20230417135305.png)
![Img](/media/img-20230417152104.png)
![Img](/media/img-20230417152453.png)
![Img](/media/img-20230417153121.png)
![Img](/media/img-20230417140152.png)
![Img](/media/img-20230417135353.png)
![Img](/media/img-20230417153408.png)

**（3）完整代码程序**
![Img](/media/img-20230417153527.png)

## 5.实验结果：                                                                                
按照之前的方式将程序下载至Micro: bit主板，利用外接电源供电。上电后，按一下Micro: bit主板上的复位按钮，通过Micro: bit主板上的A B键来控制4自由度机械手臂的舵机2（底座转动舵机）转动，按A键的时候4自由度机械手臂的舵机2（底座转动舵机）向左转，按B键的时候4自由度机械手臂的舵机2（底座转动舵机）向右转。










